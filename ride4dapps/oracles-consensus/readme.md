## Коненсус оракулов

Схема работы проста:
    +++ 1) Любой аккаунт может зарегистрироваться как оракул каких-то данных. При регистрации оракул обязан указать какие данные может предоставлять. Делается с помощью вызова `registerAsOracle(dataType: String)`, который в качестве аргумента принимает строку - тип предоставляемых данных. В данный момент в протоколе существуют следующие типы:
        - `Temperature`
        - `Currency`
        - `Sports`
        - `Random`
    То есть вызов будет `registerAsOracle("Temperature")`. В этот момент в стейте dApp будет записано: `{oraclePubKey}_Temperature={current_height}`. 
    +++ 2) Любой аккаунт может "задать вопрос" оракулам. При задании вопроса необходимо прикладывать награду для оракулов за предоставление корректных данных (пока только Waves). Задается вопрос с помощью вызова функции `request(id: String, question: String, minOraclesCount: Int, maxOraclesCount: Int, oraclesWhiteList: String, tillHeight: Int)`. Где:
        - `id` - уникальный идентификатор каждого вопроса, генерируется задающим вопрос. Требование - отсутствие такого же ключа у dApp, не больше 64 символов.
        - `question` - непосредственно задаваемый вопрос. Вопрос формируется в специальном формате для каждого типа данных, в начале вопроса должен стоять тип данных, после разделителя `//` идут мета данные в формате JSON. Например, для типа данных `Temperature` вопрос выглядит следующим образом: `Temperature//{"lat": "55.7558", "lon": "37.6173", "timestamp": 150000000000, "responseFormat": "NN.NN"}`. 
        - `minOraclesCount` - минимальное количество оракулов, которые должны предоставить данные, чтобы можно было получить результат. Значение не может быть меньше 3.
        - `maxOraclesCount` - максимальное количество оракулов, которые могут ответить на вопрос. Не больше 7.
        - `oraclesWhiteList` - список оракулов (публичные ключи через запятые), которые должны предоставить данные. Если значение параметра равно пустой строке, то любой оракул может предоставлять данные. 
        - `tillHeight` - Аккаунт может забрать средства после наступления данной высоты и количестве ответов < `minOraclesCount`.
    +++ 3) Ответ оракулов осуществляется с помощью метода `response(id: String, data: String)`. 
    4) Для подсчета результатов необходимо вызвать метод `getResult(id: String)`. Подсчет результатов возможен только в том случае, когда ответили больше оракулов, чем указано в `minOraclesCount`. При выборе правильного ответа используется не простое большинство,а рейтинги оракулов. Рейтинг формируется по следующей логике:
        - каждый оракул имеет рейтинг 1000 при регистрации
        - за каждый ответ, который в итоге стал результатом, оракул получает +1 рейтинга, за каждый неверный -1



Ограничения на контракт:
    - Максимальное количество оракулов не может превышать 7.


Проблемы:
1) Можно накрутить рейтинги очень просто, достаточно делать вопрос с вайтлистом из своих оракулов и отвечать ими.
2) Возможна атака на других оракулов, если указать несколько своих оракулов и чужого. Чужой положит данные, не зная, что остальные все хотят атаковать его.



Структуры данных: 
    Хранение ответов: 
        `${id}_${response}`: 0
        `${id}_responses`: `${response1};${response2}`